<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <title>แก้ไขรายการเคลื่อนไหว</title>
</head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f5f7ff;
    }

    /* ใช้สีทองเหมือนหัวข้อหน้ารายงานอื่น ๆ */
    .page-title {
      color: #c9a73b;
      font-weight: 700;
    }

    /* ปุ่มหลักโทนม่วงเหมือนปุ่มค้นหา / บันทึกในหน้าอื่น */
    .btn-akg-primary {
      background: linear-gradient(135deg, #7b5cff, #5a2dff);
      border: none;
      color: #ffffff;
      font-weight: 600;
      padding-inline: 1.75rem;
      box-shadow: 0 4px 10px rgba(90, 45, 255, 0.35);
    }

    .btn-akg-primary:hover {
      filter: brightness(1.05);
      box-shadow: 0 6px 16px rgba(90, 45, 255, 0.45);
    }

    /* ปุ่มรอง โทนขาว-ม่วง ให้หน้าตาไปด้วยกันกับปุ่มอื่น */
    .btn-akg-secondary {
      background-color: #ffffff;
      color: #5a2dff;
      border: 1px solid #5a2dff;
      font-weight: 500;
    }

    .btn-akg-secondary:hover {
      background-color: #f3efff;
      color: #4620d0;
      border-color: #4620d0;
    }
  </style>
</head>
</head>
<body class="bg-light">
<div class="container py-4">
  <h3 class="mb-4 page-title">แก้ไขรายการเคลื่อนไหว</h3>

  <div class="card mb-3">
    <div class="card-body">
      <form method="post">
        <!-- hidden fields สำหรับส่งค่ากลับไป update -->
        <input type="hidden" name="src_table" value="{{ src_table }}">
        <input type="hidden" name="rec_id" value="{{ rec.id }}">
        <input type="hidden" name="date_from" value="{{ date_from }}">
        <input type="hidden" name="date_to" value="{{ date_to }}">
        <input type="hidden" name="branch" value="{{ branch }}">
        <input type="hidden" name="activity" value="{{ activity }}">

        <div class="row mb-3">
          <div class="col-md-3">
            <label class="form-label">วันที่</label>
            <input type="text" class="form-control" value="{{ rec.receipt_date_str }}" disabled>
          </div>
          <div class="col-md-3">
            <label class="form-label">Branch</label>
            <input type="text" class="form-control" value="{{ rec.branch }}" disabled>
          </div>
          <div class="col-md-3">
            <label class="form-label">กิจกรรม</label>
            <input type="text" class="form-control" value="{{ rec.activity }}" disabled>
          </div>
          <div class="col-md-3">
            <label class="form-label">หน่วย</label>
            <input type="text" class="form-control" value="{{ rec.unit }}" disabled>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-4">
            <label class="form-label">รหัสวัตถุดิบ</label>
            <input type="text" class="form-control" value="{{ rec.item_code }}" disabled>
          </div>
          <div class="col-md-8">
            <label class="form-label">รายการวัตถุดิบ</label>
            <input type="text" class="form-control" value="{{ rec.item_name }}" disabled>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-4">
            <label class="form-label">จำนวน (แก้ไขได้)</label>
            <input type="number" step="1" min="0" name="quantity" class="form-control"
                   value="{{ rec.quantity|int if rec.quantity is not none else '' }}">
          </div>
          <div class="col-md-8">
            <label class="form-label">หมายเหตุ (แก้ไขได้)</label>
            <textarea name="note" class="form-control" rows="3">{{ rec.note or '' }}</textarea>
          </div>
        </div>

        <div class="mb-3">
          <label class="form-label">ไฟล์แนบเดิม</label><br>
          {% if rec.attached_file %}
            <a href="{{ rec.attached_file|file_url }}" target="_blank" class="btn btn-sm btn-outline-primary">
              เปิดไฟล์แนบ
            </a>
          {% else %}
            <span class="text-muted">ไม่มีไฟล์แนบ</span>
          {% endif %}
        </div>

        <button type="submit" class="btn btn-akg-primary">บันทึกการแก้ไข</button>
        <a href="{{ url_for('receipts',
                             date_from=date_from,
                             date_to=date_to,
                             branch=branch,
                             activity=activity) }}"
           class="btn btn-akg-secondary ms-2">ยกเลิก / กลับหน้ารายงาน</a>
      </form>
    </div>
  </div>
</div>
</body>
</html>